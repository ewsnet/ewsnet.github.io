<!DOCTYPE html>
<html>
  <head>
    {% include head.html %}
    {% include scripts/mathjax.html %}
    <script src="{{ '/assets/js/distillpub/template.v2.js' | relative_url }}"></script>
    <script src="{{ '/assets/js/distillpub/transforms.v2.js' | relative_url }}"></script>
    <!-- Import TensorFlow.js -->
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs@2.0.1/dist/tf.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <!-- Import tfjs-vis -->
    <script src="https://cdn.jsdelivr.net/npm/@tensorflow/tfjs-vis@1.0.2/dist/tfjs-vis.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/nicolaspanel/numjs@0.15.1/dist/numjs.min.js"></script>
    <script src="https://code.jscharting.com/2.9.0/jscharting.js"></script>
    <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <!-- Import the main script file -->
    {% if page._styles %}
    <style type="text/css">
      {{ page._styles }}
    </style>
    {% endif %}
    <script>
      MathJax = {
        tex: {
          inlineMath: [['$', '$'], ['\\(', '\\)']]
        }
      };
      </script>
  </head>

    <!-- <d-front-matter>
    <script async type="text/json">{
      "title": "",
      "description": "",
      "published": " Under Review ",
      "authors": [
        {% for author in page.authors %}
        {
          "author": "{{ author.name }}",
          "authorURL": "{{ author.url }}",
          "affiliations": [
            {
              "name": "{{ author.affiliations.name }}",
              "url": "{{ author.affiliations.url }}"
            }
          ]
        }{% if forloop.last == false %},{% endif %}
        {% endfor %}
      ],
      "katex": {
        "delimiters": [
          {
            "left": "$",
            "right": "$",
            "display": false
          },
          {
            "left": "$$",
            "right": "$$",
            "display": true
          }
        ]
      }
    }</script>
  </d-front-matter> -->

  <body class="{% if site.navbar_fixed %}fixed-top-nav{% endif %} {% unless site.footer_fixed %}sticky-bottom-footer{% endunless %}">

    <!-- Header -->

    {% include header.html %}

    <!-- Content -->
    
    <div class="post distill">
      <div class="row">
        <div class="col-md-2 col-lg-2"></div>
        <div class="col-md-8 col-lg-7">
          <h1 style="padding-top:2%"><span style="font-weight:bold">EWS</span><span style="font-weight:normal">Net</span>. <span style="font-size:20pt;font-weight:normal">The Early Warning Signal Network</span> </h1>
          <p>Lets anticipate critical transitions in complex systems !</p>

          <d-byline> </d-byline>
          {% comment %} <d-article > {% endcomment %}
          
          EWSNet is a <b>deep learning</b> model trained to anticipate transitions and regime shifts in complex dynamical systems. This website provides a <b> working example </b> of a trained EWSNet model that runs in your browser and can be used to make predictions on time series data. 
          For the broader general audience, we begin with an introduction to machine learning and how EWSNet fits into the context.
          <br>
          <div class="alert alert-secondary" role="alert" style="margin-top:2%">
            <b>Introduction </b>
          </div>
          <div class="alert alert-light" role="alert">
            <h6> <b> What is machine learning ? </b></h6>
            <p>
            Maintaining a level of abstraction, human intelligence, and decision-making can be understood as analogies to <b> mathematical functions </b>. The inference that we make is essentially a function that processes a set of input sensory signals, mapping it to some meaningful target domain.
            For example, when one infers <i>that is an apple</i>, it can be understood as a function that maps visual sensory signals to a known space of objects. What constitutes knowledge and intelligence then is learning such functions, and human beings learn from experience.
            </p>
            <p>
            On similar lines, one way to enable machines to make inferences is to model the task using a <b>parameterized</b> function that maps data in some input space to a desired target space.
            Machine 'learning' then refers to finding the optimal parameters for the function that best explains the data for the task at hand. Utilizing samples of data in the input and target spaces, one can learn the function that maps the input domain to the target domain. 
            This enables performing inference on a new/unseen data point. This is popularly known as supervised learning and constitutes the base for the functioning of EWSNet.
            </p>


            <div class="row mt-3">
              <div class="col-sm mt-3 mt-md-0 col-11" style="padding:2%;margin:2%">
                    <img class="img-fluid rounded z-depth-1" src="/assets/img/teaser/lstmfcn.png">
              </div>
            </div>

            <h6> <b> What is Deep learning / Neural Networks and why use them  ? </b></h6>
            <p>
              Deep neural networks are essentially parameterized functions, proven to be universal function approximators. 
              Efficiently learning from data using classical machine learning models often required handcrafting efficient feature representations for the data.
              The advent of convolutional neural networks enabled stacking multiple neural network layers and going <i>deep</i>, to <b>automatically extract features</b> that are important for learning, from raw input data.
            </p>
            

            <h6> <b> Understanding the EWSNet Architecture </b> </h6>
            <p>
              In their original form, neural networks were built to process IID data samples in fixed dimensional spaces.
              On the contrary, most real-life data such as time-series, text, audio, video, etc., are <i>sequential</i> in nature and of <i>variable length</i>.
              To be able to process such sequential data and capture the inherent dependence that is present, novel neural network architectures have been proposed, the most popular among them being <i>recurrent neural networks (RNN)</i>. RNNs process sequential data in an iterative manner, keeping a memory of data at the previous time steps. However, capturing long-term dependencies is difficult with RNNs.
              An <b>LSTM</b> is a sophisticated RNN architecture that addresses this issue by enabling the addition and deletion of information to a common memory that is propagated across time steps.
            </p>
            <p>
              Thus, EWSNet is a parameterized function that employs an LSTM to capture long-term dependencies in the sequential time series data, in addition to a fully convolutional submodule that helps automatically extract complex non-linearities from the data, requisite to learn the characteristics indicative of a future transition.
            </p>
            
          </div>
          <div class="alert alert-secondary" role="alert">
            <b>Analyze a time series for potential transitions in future</b>
          </div>
          <div class="alert alert-light" role="alert">
            <p>
              Here you can load the time series data and visualize them prior to making predictions on them using EWSNet. We provide the following two options for generating data.
              <ul style="color:black">
                <li>
                  Load some of the well studied <b>real world  </b> time series data obtained from natural systems  <b> literature </b>, known to exhibit a catastrophic transitions.
                </li>
                <li>
                  <b>Simulate</b> stochastic time series data by varying the parameters of the differential equation.
                    {% comment %} <p>
                    \begin{equation*}
                    \frac{dN}{dt} = rN(1-\frac{N}{K})-\frac{cN^{2}}{b^{2}+N^{2}}\
                    \end{equation*}
                    </p>
                    Where,
                    <ul>
                      <li>r represents the maximum growth rate</li>
                      <li>k  is the carrying capacity</li>
                      <li>b is the half saturation constant</li>
                      <li>c is the bifurcation parameter</li>
                    </ul> {% endcomment %}
                  We use the Euler Maruyama method to solve the differential equation.
                </li>
              </ul>
            </p>
            <hr class="style10">
            <p>
              <b>Load Data</b> <br>
              You can chose to load real world data or simulate stochastic time series using the options given in pane below.
            </p>
            <hr class="style10">
            
            
            <div class="row">
              <div class="col-3"></div> 
              <div class="col-6">
                <div class="list-group list-group-horizontal">
                  <button class="display_real_data list-group-item list-group-item-action active" style="text-align:center">
                   Real Data
                  </button>
                  <button class="display_simulated_data list-group-item list-group-item-action"  style="text-align:center">Simulated Data</button>
                </div>    
              </div>
            </div>

            <div class = "row">
              <div class="col-12">
                  <div id="real_world_data" style="display:display;padding:2%">
                    <p>
                      Click on the buttons provided below to load the corresponding real world data. For further details, see the references provided.
                    </p>
                    
                    <div class="btn-group" role="group" aria-label="Basic example">
                      <d-cite key="tripati2005eocene"> </d-cite><button type="button" class="btn btn-info btn-sm" style="margin:0.5%" onclick="load_real_world_data('tripati2005eocene')">End of Greenhouse</button>
                      <d-cite key="chen2018rising"> </d-cite><button type="button" class="btn btn-primary btn-sm" style="margin:0.5%" onclick="load_real_world_data('chen2018rising')">Dryland Ecosystem</button>
                      <d-cite key="demenocal2001cultural"> </d-cite><button type="button" class="btn btn-indigo btn-sm" style="margin:0.5%" onclick="load_real_world_data('demenocal2001cultural')">Desertification</button>
                    </div>
                  </div>

                  <div id="simulated_data" style="display:none;padding:2%">
                    <div class="row">
                      <div class="col-3 " style="background-color:rgba(0,50,100,0.0);padding:2%">
                        <div class="list-group list-group bifuration_model_list">
                          <button class="display_saddle_node_bifurcation list-group-item list-group-item-action active" style="text-align:center">
                          Saddle Node
                          </button>
                          <button class="display_transcritical_bifurcation list-group-item list-group-item-action"  style="text-align:center">Transcritical</button>
                        </div>    
                      </div>

                      <div class="col-9">
                        {% comment %} Saddle Node Bifurcation {% endcomment %}
                        <div id="saddle_node_bifurcation" style="padding:2%">
                          <p style="text-align:center">
                            <u><b>Differential Equation For Saddle Node Bifurcation</b></u> <br>
                          </p>
                          <p>
                            \begin{equation*}
                            \frac{dN}{dt} = rN(1-\frac{N}{K})-\frac{cN^{2}}{b^{2}+N^{2}}\
                            \end{equation*}
                            Where,
                            <ul>
                              <li>$r$ represents the maximum growth rate</li>
                              <li>$k$  is the carrying capacity</li>
                              <li>$b$ is the half saturation constant</li>
                              <li>$c$ is the bifurcation parameter</li>
                            </ul>
                            Enter the required parameter values for the differential equation below
                          </p>
                          <hr class="style10">
                          
                          <div class="form-row">
                            <div class="col">
                              <div class="input-group mb-3">
                                <div class="input-group-prepend">
                                  <span class="input-group-text" id="basic-addon1">$r$ </span>
                                </div>
                                <input type="number" class="form-control" placeholder=1 value=1 name="max_growth_rate" aria-label="max_growth_rate" aria-describedby="basic-addon1">
                              </div>
                            </div>
                            <div class="col">
                              <div class="input-group mb-3">
                                <div class="input-group-prepend">
                                  <span class="input-group-text" id="basic-addon2">$k$ </span>
                                </div>
                                <input type="number" class="form-control" placeholder=8 value=8 name="carrying_capacity" aria-label="carrying_capacity" aria-describedby="basic-addon2">
                              </div>
                            </div>
                          </div>
                          <div class="form-row">
                            <div class="col">
                              <div class="input-group mb-3">
                                <div class="input-group-prepend">
                                  <span class="input-group-text" id="basic-addon3">$b$ </span>
                                </div>
                                <input type="number" class="form-control" placeholder=1 value=1 name="half_saturation_constant" aria-label="half_saturation_constant" aria-describedby="basic-addon3">
                              </div>
                            </div>
                            <div class="col">
                              <div class="input-group mb-3" style="display: none">
                                <div class="input-group-prepend">
                                  <span class="input-group-text" id="basic-addon4">$c$ </span>
                                </div>
                                <input type="number" class="form-control" value=1 placeholder="1 (should be less than 3)"  name="bifurcation_parameter" aria-label="bifurcation_parameter" aria-describedby="basic-addon4">
                              </div>
                            </div>
                          </div>
                        </div>
                        {% comment %} Transcritical Bifurcation {% endcomment %}
                        <div id="transcritical_bifurcation" style="display:none;padding:2%">
                          <p  style="text-align:center">
                            <u><b>Differential Equation For Transcritical Bifurcation</b></u> <br>
                          </p>
                          <p>
                            \begin{equation*}
                            \frac{dN}{dt} =  rN(1-\frac{N}{K})-{cN}
                            \end{equation*}
                            Where,
                            <ul>
                              <li> $r$ represents the maximum growth rate</li>
                              <li> $k$  is the carrying capacity</li>
                              <li> $c$ denotes maximum grazing rate</li>
                            </ul>
                            Enter the required parameter values for the differential equation below
                          </p>
                          <hr class="style10">
                          
                          <div class="form-row">
                            <div class="col">
                              <div class="input-group mb-3">
                                <div class="input-group-prepend">
                                  <span class="input-group-text" id="basic-addon1">$r$ </span>
                                </div>
                                <input type="number" class="form-control" placeholder=1 value=1 name="max_growth_rate" aria-label="max_growth_rate" aria-describedby="basic-addon1">
                              </div>
                            </div>
                            <div class="col">
                              <div class="input-group mb-3">
                                <div class="input-group-prepend">
                                  <span class="input-group-text" id="basic-addon2">$k$ </span>
                                </div>
                                <input type="number" class="form-control" placeholder=10 value=10 name="carrying_capacity" aria-label="carrying_capacity" aria-describedby="basic-addon2">
                              </div>
                            </div>
                          </div>
                          <div class="form-row">
                            <div class="col">
                              <div class="input-group mb-3" style="display: none">
                                <div class="input-group-prepend">
                                  <span class="input-group-text" id="basic-addon4">$c$</span>
                                </div>
                                <input type="number" class="form-control" placeholder=0 value=0 name="max_grazing_rate" aria-label="max_grazing_rate" aria-describedby="basic-addon4">
                              </div>
                            </div>
                          </div>
                        </div>
                        
                        {% comment %}  End of Equations and Parameters {% endcomment %}
                        <div style="text-align:center">
                          <button type="button" class="btn btn-primary  z-depth-1" id="generate_simulated_data">Generate Data</button>
                        </div>

                        <div class="text-center loading_icon_sde" style="padding:1.5%;display:none">
                            <div class="spinner-border text-primary"></div>
                            <div id="loading_message_sde" style="padding:1%"></div>
                        </div>
                      </div> 
                    </div>
                    
    

                  </div>
              </div>
            </div>
          </div>
          {% comment %} <div id="real_data" style="text-align:center;">
              <div class="row">
                <div class="col-12">
                  <label></label>

                  <input type="number" class="form-control" style="display: none;" placeholder=400 value=400 name="steps_to_consider" aria-label="steps_to_consider" aria-describedby="basic-addon1">
                  <textarea class="form-control z-depth-1" name="time_series" id="time_series" cols="30" rows="7" style="font-size:12pt" placeholder="Enter Time Series Values (Separated by Comma, Blank Space or Newline)"></textarea>
                  <br>
                  <button type="button" class="btn btn-indigo  z-depth-1" id="process_time_series" onclick="plot_timeseries()"> Process</button>
                  <button type="button" class="btn btn-light  z-depth-1" onclick="document.getElementById('time_series').value = ''">Clear</button>
                </div>
              </div>
          </div>  {% endcomment %}

            

          <div id="simulated_data" style="text-align:center;">
            <div class="row">
              <div class="col-12">
                <label></label>
                <input type="number" class="form-control" style="display: none;" placeholder=400 value=400 name="steps_to_consider" aria-label="steps_to_consider" aria-describedby="basic-addon1">
                  
                <textarea class="form-control z-depth-1" name="time_series" id="time_series" cols="30" rows="5" style="font-size:12pt" placeholder="   Time Series Data Used ..." readonly="readonly"></textarea>
                <br>
                <button type="button" class="btn btn-indigo  z-depth-1" id="visualize_time_series">Visualize</button>
                <button type="button" class="btn btn-light  z-depth-1" onclick="document.getElementById('time_series').value = ''">Clear</button>
                
              </div>
            </div>
          </div>


          <div class="text-center loading_icon_plot" style="padding:5%;display:none">
              <div class="spinner-border text-primary"></div>
              <div id="loading_message_plot" style="padding:1%"></div>
          </div>

          <div class="generate_plot" style="display:none;padding:1%">
            <div class="alert alert-secondary" role="alert">
              <b>Time Series Visualization</b>
            </div>
            <p> The given time series is visualized by the line plot below. Kindly verify the correctness of the input data point to be processed by the model . </p>
            <div class="linegraph" style="text-align:center;padding-left:10%;padding-right:10%">
              <canvas id="timeseries_visualization" width="100%"></canvas>
            </div>

            <br>
            <div style="text-align:center;">
              <div class="row">
                <div class="col-12">
                  <button type="button" class="btn btn-indigo  z-depth-1" id="make_prediction">Predict Transition Using EWSNet</button>
                </div>
              </div>
            </div>

      
          </div>


          <div class="text-center loading_icon_model" style="padding:5%;display:none">
              <div class="spinner-border text-primary"></div>
              <div id="loading_message_model" style="padding:1%"></div>
          </div>

          <div class="generate_output" style="display:none;padding:1%">
            
            <div markdown="span" class="alert alert-secondary" role="alert">
              <b>Model Prediction</b>
            </div>
            <p> The probability of the given time series undergoing a transition, as predicted by the model is summarized in the bar plot below.</p>
            <div class="barchart" style="text-align:center;padding-left:10%;padding-right:10%">
              <canvas id="model_prediction" width="10%"></canvas>
            </div>
            <div markdown="span" class="alert alert-danger" role="alert">
                <h4><b> Conclusion</b></h4>
                The characteristics in the given input time series suggest that it is likely to under go <b><span id="transition_type"></span></b> in the near future.
            </div>
          </div>
           <script type = "text/javascript" src = "https://d3js.org/d3.v4.min.js"></script>
          <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.8.0/Chart.min.js"></script>
          <script src="https://cdnjs.cloudflare.com/ajax/libs/chartjs-plugin-annotation/0.5.7/chartjs-plugin-annotation.min.js"></script> 
    
          <script src="{{'assets/js/ml/script.js' | relative_url }}"></script>

            
            
          {% comment %} </d-article> {% endcomment %}
   
          <d-appendix>
            <d-footnote-list></d-footnote-list>
            <d-citation-list></d-citation-list>
          </d-appendix>
        </div>
      </div>

      <!-- Footer -->

      {% include footer.html %}
    </div>
  </body>

  <d-bibliography src="{{ page.bibliography | prepend: '/assets/bibliography/' | relative_url }}">
  </d-bibliography>

</html>
